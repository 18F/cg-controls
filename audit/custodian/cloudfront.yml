# https://cloudcustodian.io/docs/aws/resources/distribution.html#aws-distribution-filters-distribution-config
policies:
  - name: logging-enabled
    resource: aws.distribution
    filters:
      - type: distribution-config
        key: Logging.Enabled
        value: True
  - name: logging-disabled
    resource: aws.distribution
    filters:
      - type: distribution-config
        key: Logging.Enabled
        value: False
  - name: waf-enabled
    resource: aws.distribution
    filters:
      - not:
        - type: waf-enabled
  - name: shield-enabled
    resource: aws.distribution
    filters:
      - type: shield-enabled

# TLS will be in
#"DistributionConfig": {
#      "ViewerCertificate": {
#            "MinimumProtocolVersion": "TLSv1.2_2018",
    #resource: distribution
  - name: tls-policy
    resource: aws.distribution
    filters:
      - type: distribution-config
        key: ViewerCertificate.MinimumProtocolVersion
        value: "TLSv1.2_2018"